<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>New Entry - Ourdiary</title>
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?display=swap&family=Noto+Sans:wght@400;500;700;900&family=Plus+Jakarta+Sans:wght@400;500;700;800" />
  <style>
    :root {
      --primary-bg: #fff;
      --sidebar-bg: #f1f2f4;
      --sidebar-active: #dce8f3;
      --text-main: #121416;
      --accent: #4a90e2;
      --btn-bg: #dce8f3;
      --desc: #60768a;
      --modal-bg: rgba(18, 20, 22, 0.25);
    }

    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: var(--primary-bg);
      font-family: "Plus Jakarta Sans", "Noto Sans", sans-serif;
      color: var(--text-main);
    }

    .design-root {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      background: var(--primary-bg);
      justify-content: space-between;
      max-width: 600px;
      margin: 0 auto;
      box-sizing: border-box;
    }

    .heading {
      text-align: center;
      font-size: 1.5rem;
      font-weight: 700;
      margin: 1.2rem 0 0.5rem 0;
      letter-spacing: 0.01em;
      color: var(--text-main);
    }

    .header-row {
      display: flex;
      align-items: center;
      background: var(--primary-bg);
      padding: 8px 8px 8px 8px;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 10;
      box-shadow: 0 2px 8px rgba(76, 110, 245, 0.04);
    }

    .icon-btn {
      color: var(--text-main);
      display: flex;
      width: 44px;
      height: 44px;
      min-width: 44px;
      min-height: 44px;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      border: none;
      background: none;
      cursor: pointer;
      border-radius: 50%;
      transition: background 0.15s;
    }

    .icon-btn:active {
      background: var(--sidebar-active);
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .action-btn {
      background: var(--btn-bg);
      border: none;
      border-radius: 9999px;
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background 0.15s;
    }

    .action-btn:active {
      background: #b3d3ef;
    }

    .input-row {
      padding: 1rem 1rem 0.5rem 1rem;
    }

    .input-label {
      width: 100%;
      display: block;
    }

    .form-input {
      width: 100%;
      min-height: 140px;
      border: none;
      border-radius: 12px;
      background: var(--sidebar-bg);
      font-size: 1rem;
      color: var(--text-main);
      padding: 1rem;
      resize: vertical;
      font-family: inherit;
      box-sizing: border-box;
      outline: none;
      margin-top: 0.5rem;
      margin-bottom: 0.5rem;
    }

    .form-input:focus {
      background: var(--sidebar-active);
      border: 1px solid var(--accent);
    }

    .toolbar-container {
      padding: 0.5rem 1rem 1rem 1rem;
      background: var(--primary-bg);
    }

    .toolbar-grid {
      display: flex;
      gap: 1.5rem;
      justify-content: flex-start;
      align-items: center;
    }

    .toolbar-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.3rem;
      cursor: pointer;
      background: none;
      border: none;
      outline: none;
      padding: 0;
    }

    .toolbar-icon-bg {
      background: var(--sidebar-bg);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.15s;
    }

    .toolbar-btn:hover .toolbar-icon-bg,
    .toolbar-btn:focus .toolbar-icon-bg {
      background: var(--sidebar-active);
    }

    .toolbar-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--accent);
      width: 20px;
      height: 20px;
    }

    .toolbar-label {
      font-size: 0.9rem;
      color: var(--desc);
      margin: 0;
      font-weight: 500;
    }

    .footer-spacer {
      height: 20px;
      background: var(--primary-bg);
    }

    /* Share Modal */
    .modal-bg {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: var(--modal-bg);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal-bg.active {
      display: flex;
    }

    .share-modal {
      background: #fff;
      border-radius: 1rem;
      box-shadow: 0 8px 32px rgba(76, 110, 245, 0.08);
      padding: 1.5rem 1.2rem 1.2rem 1.2rem;
      min-width: 280px;
      max-width: 95vw;
      width: 340px;
      max-height: 90vh;
      display: flex;
      flex-direction: column;
    }

    .share-modal h3 {
      margin: 0 0 1rem 0;
      font-size: 1.15rem;
      font-weight: bold;
      text-align: center;
    }

    .share-list {
      flex: 1;
      overflow-y: auto;
      margin-bottom: 1rem;
    }

    .share-item {
      display: flex;
      align-items: center;
      gap: 0.7rem;
      padding: 0.5rem 0.2rem;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.15s;
    }

    .share-item:hover,
    .share-item.selected {
      background: var(--sidebar-active);
    }

    .share-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      object-fit: cover;
      background: var(--sidebar-bg);
      flex-shrink: 0;
    }

    .share-name {
      font-weight: 500;
      font-size: 1rem;
      color: var(--text-main);
      flex: 1;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .share-checkbox {
      width: 20px;
      height: 20px;
      accent-color: var(--accent);
    }

    .modal-actions {
      display: flex;
      gap: 1rem;
      justify-content: flex-end;
      margin-top: 0.5rem;
    }

    .btn {
      background: var(--btn-bg);
      color: var(--accent);
      font-weight: bold;
      border: none;
      border-radius: 9999px;
      padding: 0.5rem 1.2rem;
      cursor: pointer;
      font-size: 1rem;
      transition: background 0.15s;
    }

    .btn.primary {
      background: var(--accent);
      color: #fff;
    }

    .btn:active {
      background: #b3d3ef;
    }

    @media (max-width: 600px) {
      .design-root {
        max-width: 100vw;
      }

      .heading {
        font-size: 1.1rem;
      }

      .toolbar-grid {
        gap: 1rem;
      }

      .share-modal {
        width: 98vw;
        min-width: 0;
      }
    }

    @media (max-width: 400px) {
      .header-row {
        padding: 4px 2px 4px 2px;
      }

      .input-row {
        padding: 0.5rem 0.3rem 0.3rem 0.3rem;
      }
    }
  </style>
</head>

<body>
  <h2 class="heading">New Entry</h2>
  <div class="design-root">
    <div>
      <div class="header-row">
        <button class="icon-btn" id="closeBtn" aria-label="Close">
          <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
            <path
              d="M205.66,194.34a8,8,0,0,1-11.32,11.32L128,139.31,61.66,205.66a8,8,0,0,1-11.32-11.32L116.69,128,50.34,61.66A8,8,0,0,1,61.66,50.34L128,116.69l66.34-66.35a8,8,0,0,1,11.32,11.32L139.31,128Z">
            </path>
          </svg>
        </button>
        <div class="header-actions">
          <button class="action-btn" id="saveBtn" aria-label="Save">
            <div class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor"
                viewBox="0 0 256 256">
                <path
                  d="M229.66,77.66l-128,128a8,8,0,0,1-11.32,0l-56-56a8,8,0,0,1,11.32-11.32L96,188.69,218.34,66.34a8,8,0,0,1,11.32,11.32Z">
                </path>
              </svg>
            </div>
          </button>
        </div>
      </div>
      <div class="input-row">
        <label class="input-label">
          <textarea placeholder="Write your diary entry here..." class="form-input" id="entryText"></textarea>
        </label>
      </div>
    </div>
    <div>
      <div class="toolbar-container">
        <div class="toolbar-grid">
          <!-- Add Photo -->
          <div class="toolbar-btn" tabindex="0">
            <div class="toolbar-icon-bg">
              <div class="toolbar-icon">
                <label style="margin:0;">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" fill="currentColor"
                    viewBox="0 0 256 256">
                    <path
                      d="M216,40H40A16,16,0,0,0,24,56V200a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40Zm0,16V158.75l-26.07-26.06a16,16,0,0,0-22.63,0l-20,20-44-44a16,16,0,0,0-22.62,0L40,149.37V56ZM40,172l52-52,80,80H40Zm176,28H194.63l-36-36,20-20L216,181.38V200ZM144,100a12,12,0,1,1,12,12A12,12,0,0,1,144,100Z">
                    </path>
                  </svg>
                  <input id="upload" type="file" accept="image/*" style="display: none;" />
                </label>
              </div>
            </div>
            <p class="toolbar-label">Add Photo</p>
          </div>
          <!-- Share Entry -->
          <button class="toolbar-btn" id="shareBtn" tabindex="0">
            <div class="toolbar-icon-bg">
              <div class="toolbar-icon">
                <!-- Share/Post SVG -->
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                  viewBox="0 0 256 256">
                  <path
                    d="M240,128a8,8,0,0,1-8,8H88.66l43.17,43.17a8,8,0,1,1-11.32,11.32l-56-56a8,8,0,0,1,0-11.32l56-56a8,8,0,1,1,11.32,11.32L88.66,120H232A8,8,0,0,1,240,128Z">
                  </path>
                </svg>
              </div>
            </div>
            <p class="toolbar-label">Share Entry</p>
          </button>
        </div>
      </div>
      <div class="footer-spacer"></div>
    </div>
  </div>
  <!-- Share Modal -->
  <div class="modal-bg" id="shareModalBg">
    <div class="share-modal">
      <h3>Share Entry</h3>
      <div class="share-list" id="shareList"></div>
      <div class="modal-actions">
        <button class="btn" id="closeShareModal">Cancel</button>
        <button class="btn primary" id="confirmShareBtn">Share</button>
      </div>
    </div>
  </div>
  <script>
    // Demo friends/groups data (replace with backend fetch as needed)
    let friends = JSON.parse(localStorage.getItem('friends')) || [
      { id: 1, name: "Alex", avatar: "Avatars/Ava.png" },
      { id: 2, name: "Chris", avatar: "Avatars/Chris.png" },
      { id: 3, name: "Sophie", avatar: "Avatars/sophie.png" }
    ];
    let groups = JSON.parse(localStorage.getItem('groups')) || [
      { id: 'g1', name: "Family", avatar: "Avatars/Lana.png" },
      { id: 'g2', name: "Besties", avatar: "Avatars/Lyla.png" }
    ];

    // Close button: go back to home page
    document.getElementById('closeBtn').addEventListener('click', function () {
      window.location.href = 'index.html';
    });

    // Save button: show message or redirect (customize as needed)
    document.getElementById('saveBtn').addEventListener('click', function () {
      const text = document.getElementById('entryText').value.trim();
      if (!text) {
        alert('Please write something before saving!');
        return;
      }
      // Simulate save (replace with your save logic)
      alert('Entry saved!');
      window.location.href = 'index.html';
    });

    // Add Photo: handle file upload (you can add preview logic here)
    document.getElementById('upload').addEventListener('change', function (event) {
      const file = event.target.files[0];
      if (file) {
        alert('Photo selected: ' + file.name);
        // You can show a preview or upload the image here.
      }
    });

    // Share Entry Modal logic
    const shareBtn = document.getElementById('shareBtn');
    const shareModalBg = document.getElementById('shareModalBg');
    const shareList = document.getElementById('shareList');
    const closeShareModal = document.getElementById('closeShareModal');
    const confirmShareBtn = document.getElementById('confirmShareBtn');

    let selectedShares = new Set();

    function renderShareList() {
      shareList.innerHTML = '';
      // Friends
      if (friends.length) {
        const fTitle = document.createElement('div');
        fTitle.textContent = "Friends";
        fTitle.style = "font-weight:bold;color:#60768a;margin:.3rem 0 .1rem .1rem;font-size:.95rem;";
        shareList.appendChild(fTitle);
        friends.forEach(friend => {
          const div = document.createElement('div');
          div.className = 'share-item';
          div.innerHTML = `
            <img class="share-avatar" src="${friend.avatar}" alt="${friend.name}">
            <span class="share-name">${friend.name}</span>
            <input type="checkbox" class="share-checkbox" data-id="f${friend.id}">
          `;
          shareList.appendChild(div);
        });
      }
      // Groups
      if (groups.length) {
        const gTitle = document.createElement('div');
        gTitle.textContent = "Groups";
        gTitle.style = "font-weight:bold;color:#60768a;margin:.6rem 0 .1rem .1rem;font-size:.95rem;";
        shareList.appendChild(gTitle);
        groups.forEach(group => {
          const div = document.createElement('div');
          div.className = 'share-item';
          div.innerHTML = `
            <img class="share-avatar" src="${group.avatar}" alt="${group.name}">
            <span class="share-name">${group.name}</span>
            <input type="checkbox" class="share-checkbox" data-id="g${group.id}">
          `;
          shareList.appendChild(div);
        });
      }
      // Checkbox logic
      shareList.querySelectorAll('.share-checkbox').forEach(box => {
        box.addEventListener('change', function () {
          if (this.checked) selectedShares.add(this.dataset.id);
          else selectedShares.delete(this.dataset.id);
        });
      });
      // Row click also toggles checkbox
      shareList.querySelectorAll('.share-item').forEach(row => {
        row.addEventListener('click', function (e) {
          if (e.target.classList.contains('share-checkbox')) return;
          const box = row.querySelector('.share-checkbox');
          box.checked = !box.checked;
          box.dispatchEvent(new Event('change'));
        });
      });
    }

    shareBtn.addEventListener('click', function () {
      selectedShares = new Set();
      renderShareList();
      shareModalBg.classList.add('active');
    });

    closeShareModal.addEventListener('click', function () {
      shareModalBg.classList.remove('active');
    });

    confirmShareBtn.addEventListener('click', function () {
      if (selectedShares.size === 0) {
        alert("Select at least one friend or group to share.");
        return;
      }
      alert("Entry shared with: " + Array.from(selectedShares).join(', '));
      shareModalBg.classList.remove('active');
      // Here you would actually send/share the entry
    });

    // Optional: Keyboard accessibility for toolbar
    document.querySelectorAll('.toolbar-btn').forEach(btn => {
      btn.addEventListener('keydown', function (e) {
        if (e.key === 'Enter' || e.key === ' ') {
          btn.click();
        }
      });
    });
  </script>
</body>

</html>